# 離散フーリエ変換

- 与えられた数列は${1,2,5,8,4,10,1,…}$
- 与えられた数列は以下の表のECA(Rule90)によって得られている
  - ここでは1から始まり1に戻る周期性を持っている
  - 周期性はセル幅が$2^n (n>0)$の時に得られ、$2^{(n+1)}-2$回の計算で初期値と同じ値になる
    - 例）以下の表では$n=2$なのでセル幅は4、周期は$2^3-2=6$となる

|10進数|セル0|セル1|セル2|セル3|
|  --:|  --:| --:| --:| --:|
|    1|    0|   0|   0|   1|
|    2|    0|   0|   1|   0|
|    5|    0|   1|   0|   1|
|    8|    1|   0|   0|   0|
|    4|    0|   1|   0|   0|
|   10|    1|   0|   1|   0|
|    1|    0|   0|   0|   1|

## 計算

$X$は離散周波数スペクトル密度

$T_0$の単位は秒．観測開始0秒から$T_0$秒までを観測したということ

$x$は$0\sim T_0$秒までに等間隔$$\Delta t$$秒で得られた$N$個の離散的な数値列

$W_n$は$$W_N=e^{-i\frac{2\pi}{N}}$$，つまり$$W_n=\cos\left(\frac{2\pi}{N}\right)-i\sin\left(\frac{2\pi}{N}\right)$$で得られる
$$
\begin{align*}
\begin{pmatrix} 
X_0 \\
X_1 \\
X_2 \\
X_3 \\
X_4 \\
X_5 \\
\end{pmatrix}
&=
\frac{T_0}{6}
\begin{pmatrix} 
W_6^0 & W_6^0 & W_6^0    & W_6^0    & W_6^0    & W_6^0    \\
W_6^0 & W_6^1 & W_6^2    & W_6^3    & W_6^4    & W_6^5    \\
W_6^0 & W_6^2 & W_6^4    & W_6^6    & W_6^8    & W_6^{10} \\
W_6^0 & W_6^3 & W_6^6    & W_6^9    & W_6^{12} & W_6^{15} \\
W_6^0 & W_6^4 & W_6^8    & W_6^{12} & W_6^{16} & W_6^{20} \\
W_6^0 & W_6^5 & W_6^{10} & W_6^{15} & W_6^{20} & W_6^{25} \\
\end{pmatrix}
\begin{pmatrix} 
x_0 \\
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5 \\
\end{pmatrix}\\
&=
\frac{1}{6}
\begin{pmatrix} 
W_6^0 & W_6^0 & W_6^0 & W_6^0 & W_6^0 & W_6^0 \\
W_6^0 & W_6^1 & W_6^2 & W_6^3 & W_6^4 & W_6^5 \\
W_6^0 & W_6^2 & W_6^4 & W_6^0 & W_6^2 & W_6^4 \\
W_6^0 & W_6^3 & W_6^0 & W_6^3 & W_6^0 & W_6^3 \\
W_6^0 & W_6^4 & W_6^2 & W_6^0 & W_6^4 & W_6^2 \\
W_6^0 & W_6^5 & W_6^4 & W_6^3 & W_6^2 & W_6^1 \\
\end{pmatrix}
\begin{pmatrix} 
1  \\
2  \\
5  \\
8  \\
4  \\
10 \\
\end{pmatrix}
\end{align*}
$$

$W_6$について求める
$$
\begin{align*}
W_6 &= e^{-i\frac{2\pi}{6}}\\
    &= \frac{1}{2}\left(1-i\sqrt{3}\right)
\end{align*}
$$

よって$W_6^0 \sim W_6^5$の値は
$$
\begin{align*}
W_n^0 &= \left(\frac{1}{2}\left(1-i\sqrt{3}\right)\right)^0 \\
      &= 1
\end{align*}
$$
